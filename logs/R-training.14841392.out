Mon Apr  3 01:59:51 CDT 2023
my_file_prefix = configure3.txt
reading configuration file= configure.txt

{'NN_string': 'SEQ', 'nepochs': 100, 'batch_size': 18, 'n_filters_for_first_layer': 32, 'double_filters': False, 'loss': 'my_mean_squared_error_weighted_genexp', 'loss_weight': (1.0, 5.0, 4.0), 'K12_WTD_ALL_3x3_T': {'data_suffix': 'rescaleC09'}}

machine = notHera
start MAIN_TRAIN_and_SAVE_MODEL= 2023-04-03 01:59:53.729535
data_suffix = 
loading data from file = gremlin.npz
Loading data from file: gremlin.npz
Assigning to variables:
   Xdata_train, Ydata_train
   Xdata_test, Y_data_test
   Lat/Lon

ny,nx= 256 256
nchans= 4
nbatches train,test= 1798 448
no scalars
Configuration:
NN_string = SEQ
activ = relu
activ_last = linear
activ_scalar = relu
batch_size = 18
batchnorm= False
convfilter = (3, 3)
convfilter_last_layer = (1, 1)
convfilter_scalar = (1, 1)
double_filters = False
dropout =  False
kernel_init = glorot_uniform
n_conv_layers_per_decoder_layer = 1
n_conv_layers_per_encoder_layer = 1
n_encoder_decoder_layers = 3
n_filters_for_first_layer = 32
n_filters_last_layer = 1
n_filters_scalars = 16
n_scalar_layers = 2
nepochs = 100
poolfilter = (2, 2)
upfilter = (2, 2)
IS_UNET = False
encoder layer_format = CP
decoder layer_format = CP
optimizer = Adam
padding =  same

Results will be stored here:
   Model file: ../conus2_ml/models/OUTPUT/MODEL/model_configure3.txt_SEQ_blocks_3_epochs_100.h5
   History file: ../conus2_ml/models/OUTPUT/MODEL/history_configure3.txt_SEQ_blocks_3_epochs_100.bin

start 2023-04-03 01:59:58.400830
Add encoder layer #0
Add encoder layer #1
Add encoder layer #2
Add decoder layer #0
Add decoder layer #1
Add decoder layer #2
SEQ !!!!


Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 256, 256, 4)]     0         
                                                                 
 conv2d (Conv2D)             (None, 256, 256, 32)      1184      
                                                                 
 max_pooling2d (MaxPooling2D  (None, 128, 128, 32)     0         
 )                                                               
                                                                 
 conv2d_1 (Conv2D)           (None, 128, 128, 32)      9248      
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 64, 64, 32)       0         
 2D)                                                             
                                                                 
 conv2d_2 (Conv2D)           (None, 64, 64, 32)        9248      
                                                                 
 max_pooling2d_2 (MaxPooling  (None, 32, 32, 32)       0         
 2D)                                                             
                                                                 
 conv2d_3 (Conv2D)           (None, 32, 32, 32)        9248      
                                                                 
 up_sampling2d (UpSampling2D  (None, 64, 64, 32)       0         
 )                                                               
                                                                 
 conv2d_4 (Conv2D)           (None, 64, 64, 32)        9248      
                                                                 
 up_sampling2d_1 (UpSampling  (None, 128, 128, 32)     0         
 2D)                                                             
                                                                 
 conv2d_5 (Conv2D)           (None, 128, 128, 32)      9248      
                                                                 
 up_sampling2d_2 (UpSampling  (None, 256, 256, 32)     0         
 2D)                                                             
                                                                 
 conv2d_6 (Conv2D)           (None, 256, 256, 1)       33        
                                                                 
 reshape (Reshape)           (None, 256, 256)          0         
                                                                 
=================================================================
Total params: 47,457
Trainable params: 47,457
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/100
Mon Apr  3 02:00:00 CDT 2023
